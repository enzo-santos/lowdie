# Lowdie

A nice Telegram bot who plays games.

This bot uses Node.js with the [`node-telegram-bot-api` module](https://github.com/yagop/node-telegram-bot-api).

- Games:

    - [X] Rock-paper-scissors
    - [X] Tic-tac-toe
    - [ ] Hangman
    - [ ] Battleship
    
## Usage

### As user

Start a conversation with [@lowdiebot](https://t.me/lowdiebot) on Telegram.

### As developer

1. Clone this repository. The working directory to be used in this explanation will be */path/until/cloned/repository/lowdiebot*.

2. Run

```
npm install
```

3. Create a self-signed SSL certificate using [this guide](https://github.com/yagop/node-telegram-bot-api/blob/master/doc/usage.md#webhooks)
and put the file in the current working directory. In this repository, the public key is stored in *crt.pem*.
   
#### Hosting the bot locally

4.1. Create a file *local.settings.json* file with contents

```lang-none
{
  "IsEncrypted": false,
  "Values": {
    "FUNCTIONS_WORKER_RUNTIME": "node",
    "AzureWebJobsStorage": "",
    "LOWDIE_TOKEN": "...",
    "WEBHOOK_ADDRESS": "..."
  }
}
```

In the `LOWDIE_TOKEN` entry, put the [authentication token](https://core.telegram.org/bots#6-botfather) generated by 
Telegram for your bot. In the `WEBHOOK_ADDRESS` entry, put the [invoke URL](https://docs.microsoft.com/en-us/azure/azure-functions/create-first-function-cli-typescript?tabs=azure-cli%2Cbrowser#deploy-the-function-project-to-azure)
generated by Azure for your application. 


4.2. Run

```lang-none
npm start
```

#### Hosting the bot on the cloud

The cloud platform used is Azure Functions with Typescript support.

4.1. Set up an Azure account.

4.2. Create a function application on Azure and publish it using [this guide](https://docs.microsoft.com/en-us/azure/azure-functions/create-first-function-cli-typescript?tabs=azure-cli%2Cbrowser#create-supporting-azure-resources-for-your-function).

4.3. Set the environment variables `LOWDIE_TOKEN` and `WEBHOOK_ADDRESS` (described before) using [the Azure portal](https://docs.microsoft.com/en-us/azure/azure-functions/functions-how-to-use-azure-function-app-settings?tabs=portal#settings).
